###
# This is the default TS-setup for dr_blob, Version 2.2.0
###
plugin.tx_drblob_pi1 = USER
plugin.tx_drblob_pi1 {
  userFunc = tx_drblob_pi1->main

  templateFile = EXT:dr_blob/res/dr_blob.tmpl
  fileExtIconFolder = {$plugin.tx_drblob.fileExtIconFolder}
  searchFieldList = title,description,blob_name,t3ver_label
  emptySearchAtStart = 1
  tryToOpenFileInline = 1
  downloadFilenameUserFunc = 
  
  listView {
    limit = 25
    listOrderBy = title
    listOrderDir = 0
    altSubpartMarker = TEMPLATE_LIST
    alternatingLayouts = {$plugin.tx_drblob.alternatingLayouts}
    categoryDivider = ,
    categoryMode = 0
    categorySelection = 
    
    age_stdWrap {
      age = 1
    }

    author_stdWrap {
      wrap = |
    }

    category_stdWrap {
      wrap = |
    }

    date_stdWrap {
      date = {$plugin.tx_drblob.stdDateWrap}
    }
    
    description_stdWrap {
      stripHtml = 1
      crop < {$plugin.tx_drblob.lenghtOfDescription}
    }
    
    downloadLink_stdWrap {
      wrap = |
      typolink {
        ATagBeforeWrap = 1
        ATagParams = class="tx_drblob_downloadlink"
      }
    }
    
    downloadcount_stdWrap {
      wrap = |
    }

    email_stdWrap {
      wrap = |
      typolink {
        ATagParams = class="tx_drblob_emaillink"
      }
    }
    
    fileicon_stdWrap {
      wrap = |
      cObject = IMAGE
      cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.file.import.field = blob_filext
      cObject.file.import.wrap = |.gif
      cObject.altText.field = blob_filext
      cObject.titleText.field = blob_filext

      cObject.stdWrap.ifEmpty.cObject = IMAGE
      cObject.stdWrap.ifEmpty.cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.stdWrap.ifEmpty.cObject.file.import.wrap = default.gif
    }
    
    filename_stdWrap {
      wrap = |
    }
    
    filesize_stdWrap {
      bytes = 1
      bytes.labels = B| KB| MB| GB
      wrap = |
    }
    
    filechecksum_stdWrap {
      wrap = |
    }
    
    filetype_stdWrap {
      wrap = |
    }
    
    moreLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        useCacheHash = 1
        no_cache = 0
        ATagParams = class="tx_drblob_morelink"
      }
    }
    
    title_stdWrap {
      wrap = |
    }

	version_stdWrap {
      wrap = |
    }
    
    vFolderTree_stdWrap {
      wrap = <div class="tx_drblob_list-vFolderTree">|</div>
    }
    
    vFolderTitleNO_stdWrap {
      wrap = |
    }

    vFolderTitleACT_stdWrap {
      wrap = <b>|</b>
    }
    
    vFolderIcon = IMAGE
    vFolderIcon {
      file = EXT:dr_blob/res/folder.gif
      border = 0
      params = style="vertical-align: bottom; margin-right: 2px;" align="top" class="c-recIcon"
    }
    
    vFolderGfxFolder = typo3conf/ext/dr_blob/res/vFolderTree/
    vFolderTreeEnable = 0
    vFolderTreeInitialState = none
    vFolderTree_FolderSubscriptionMode = selected
  }


  topView {
    limit = 5
    listOrderBy = crdate
    listOrderDir = 1
    altSubpartMarker = TEMPLATE_PERSONAL
    alternatingLayouts = {$plugin.tx_drblob.alternatingLayouts}
    categoryDivider = ,
    categoryMode = 0
    categorySelection = 
    
    age_stdWrap {
      age = 1
    }

    author_stdWrap {
      wrap = |
    }

    category_stdWrap {
      wrap = <p>|</p>
    }
    
    date_stdWrap {
      date = {$plugin.tx_drblob.stdDateWrap}
    }
    
    description_stdWrap {
      wrap = <p>|</p>
      stripHtml = 1
      crop = {$plugin.tx_drblob.lenghtOfDescription}
    }
        
    downloadLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        ATagParams = class="tx_drblob_downloadlink"
      }
    }
    
    downloadcount_stdWrap {
      wrap = |
    }

    email_stdWrap {
      wrap = |
      typolink {
        ATagParams = class="tx_drblob_emaillink"
      }
    }
    
    fileicon_stdWrap {
      wrap = |
      cObject = IMAGE
      cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.file.import.field = blob_filext
      cObject.file.import.wrap = |.gif
      cObject.altText.field = blob_filext
      cObject.titleText.field = blob_filext

      cObject.stdWrap.ifEmpty.cObject = IMAGE
      cObject.stdWrap.ifEmpty.cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.stdWrap.ifEmpty.cObject.file.import.wrap = default.gif
    }
    
    filename_stdWrap {
      wrap = |
    }
    
    filesize_stdWrap {
      bytes = 1
      bytes.labels = B| KB| MB| GB
      wrap = |
    }
    
    filechecksum_stdWrap {
      wrap = |
    }
    
    filetype_stdWrap {
      wrap = |
    }
    
    moreLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        useCacheHash = 1
        no_cache = 0
        ATagParams = class="tx_drblob_morelink"
      }
    }
    
	version_stdWrap {
      wrap = |
    }
    
    title_stdWrap {
      wrap = |
    }
  }
  
  
  personalView {
    limit = 5
    listOrderBy = tstamp
    listOrderDir = 1
    alternatingLayouts = {$plugin.tx_drblob.alternatingLayouts}
    altSubpartMarker = TEMPLATE_PERSONAL
    categoryDivider = ,
    categoryMode = 0
    categorySelection = 
    
    age_stdWrap {
      age = 1
    }

    author_stdWrap {
      wrap = |
    }

    category_stdWrap {
      wrap = <p>|</p>
    }

    date_stdWrap {
      date = {$plugin.tx_drblob.stdDateWrap}
    }
    
    description_stdWrap {
      wrap = <p>|</p>
      stripHtml = 1
      crop = {$plugin.tx_drblob.lenghtOfDescription}
    }
    
    downloadLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        ATagParams = class="tx_drblob_downloadlink"
      }
    }
    
    downloadcount_stdWrap {
      wrap = |
    }

    email_stdWrap {
      wrap = |
      typolink {
        ATagParams = class="tx_drblob_emaillink"
      }
    }

    fileicon_stdWrap {
      wrap = |
      cObject = IMAGE
      cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.file.import.field = blob_filext
      cObject.file.import.wrap = |.gif
      cObject.altText.field = blob_filext
      cObject.titleText.field = blob_filext

      cObject.stdWrap.ifEmpty.cObject = IMAGE
      cObject.stdWrap.ifEmpty.cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.stdWrap.ifEmpty.cObject.file.import.wrap = default.gif
    }
    
    filename_stdWrap {
      wrap = |
    }
    
    filesize_stdWrap {
      bytes = 1
      bytes.labels = B| KB| MB| GB
      wrap = |
    }
    
    filechecksum_stdWrap {
      wrap = |
    }
    
    filetype_stdWrap {
      wrap = |
    }
    
    moreLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        useCacheHash = 1
        no_cache = 0
        ATagParams = class="tx_drblob_morelink"
      }
    }
    
	version_stdWrap {
      wrap = |
    }
    
    title_stdWrap {
      wrap = |
    }
  }


  singleView {
    altSubpartMarker = TEMPLATE_SINGLE
    
    substitutePagetitle = 1
    substituteIndextitle = 1

    categoryDivider = ,
    
    age_stdWrap {
      age = 1
    }

    author_stdWrap {
      wrap = |
    }
    
    backLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        ATagParams = class="tx_drblob_backlink"
      }
    }
    
    category_stdWrap {
      wrap = <ul>|</ul>
      split {
        token < plugin.tx_drblob_pi1.singleView.categoryDivider 
        cObjNum = 1
        1.current = 1
        1.wrap = <li>|</li>
      }
    }

    date_stdWrap {
      date = {$plugin.tx_drblob.stdDateWrap} h:i a
    }
    
    description_stdWrap {
      stripHtml = 0
      crop >
    }
    
    downloadLink_stdWrap {
      wrap = |      
      typolink {
        ATagBeforeWrap = 1
        ATagParams = class="tx_drblob_downloadlink"
      }
    }
    
    downloadcount_stdWrap {
      wrap = |
    }

    email_stdWrap {
      wrap = |
      typolink {
        ATagParams = class="tx_drblob_emaillink"
      }
    }
    
    fileicon_stdWrap {
      wrap = |
      cObject = IMAGE
      cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.file.import.field = blob_filext
      cObject.file.import.wrap = |.gif
      cObject.altText.field = blob_filext
      cObject.titleText.field = blob_filext

      cObject.stdWrap.ifEmpty.cObject = IMAGE
      cObject.stdWrap.ifEmpty.cObject.file.import < plugin.tx_drblob_pi1.fileExtIconFolder
      cObject.stdWrap.ifEmpty.cObject.file.import.wrap = default.gif
    }
    
    filename_stdWrap {
      wrap = |
    }
    
    filesize_stdWrap {
      bytes = 1
      bytes.labels = Bytes| KiloBytes| MegaBytes| GigaBytes
      wrap = |
    }
    
    filechecksum_stdWrap {
      wrap = |
    }
    
    filetype_stdWrap {
      wrap = |
    }
    
	version_stdWrap {
      wrap = |
    }
    
    title_stdWrap {
      wrap = <strong>|</strong>
    }
  }


  _LOCAL_LANG {
    default {
      list_button_download = [download]
      list_button_show = [more]
      personal_button_download = [download]
      personal_button_show = [more]
      top_button_download = [download]
      top_button_show = [more]
    }
  }
  
  _CSS_DEFAULT_STYLE (
    .tx_drblob_list {}
    th.tx_drblob_list-head {}
    td.tx_drblob_list-row1{}
    td.tx_drblob_list-row2{}
    
    div.tx_drblob_list-vFolderTree { float:left; }
    
    .tx_drblob_top {}
    th.tx_drblob_top-head {}
    th.tx_drblob_top-foot {}
    td.tx_drblob_top-row1 {}
    td.tx_drblob_top-row2 {}
    
    .tx_drblob_personal {}
    th.tx_drblob_personal-head {}
    th.tx_drblob_personal-foot {}
    td.tx_drblob_personal-row1 {}
    td.tx_drblob_personal-row2 {}
    .tx_drblob_personal-btn { margin-top: 15px; }
    
    .tx_drblob_single {}
  )
}


plugin.tx_linkhandler.tx_drblob_content {
  forceLink = 0
  parameter = {$plugin.tx_drblob.downloadPID}
  no_cache = 1
  additionalParams = &tx_drblob_pi1[downloadUid]={field:uid}
  additionalParams.insertData = 1 
  useCacheHash = 0
}